name: lab

topology:
  nodes:
    r1:
      kind: linux
      image: frr-ssh
      binds:
        - ./configs/frr-daemons.cfg:/etc/frr/daemons
        - ./configs/r1/frr.conf:/etc/frr/frr.conf
      ports:
        - "2223:22/tcp"
    h1:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 192.168.10.2/24 dev eth1
        - ip route del default
        - ip route add default via 192.168.10.1 dev eth1
      ports:
        - "2224:22/tcp"
    h2:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 192.168.20.2/24 dev eth1
        - ip route del default
        - ip route add default via 192.168.20.1 dev eth1
      ports:
        - "2225:22/tcp"
    h3:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 192.168.30.2/24 dev eth1
        - ip route del default
        - ip route add default via 192.168.30.1 dev eth1
      ports:
        - "2226:22/tcp"
  links:   
    - endpoints: ["r1:eth1", "h1:eth1"]
    - endpoints: ["r1:eth2", "h2:eth1"]
    - endpoints: ["r1:eth3", "h3:eth1"]

